{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/Users/ansmu/Desktop/Web/course-mark-management/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _regenerator from \"C:/Users/ansmu/Desktop/Web/course-mark-management/frontend/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"C:/Users/ansmu/Desktop/Web/course-mark-management/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"C:/Users/ansmu/Desktop/Web/course-mark-management/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.array.join.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.date.to-iso-string.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url.to-json.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { mapGetters } from 'vuex';\nimport * as bootstrap from 'bootstrap';\nexport default {\n  name: 'MarksManagement',\n  data: function data() {\n    return {\n      courseId: this.$route.params.courseId || '',\n      course: null,\n      students: [],\n      lecturerCourses: [],\n      isLoading: false,\n      unsavedChanges: false\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters('auth', ['getUser', 'userId'])), {}, {\n    currentUser: function currentUser() {\n      return this.getUser;\n    }\n  }),\n  created: function created() {\n    var _this = this;\n    return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n      return _regenerator().w(function (_context) {\n        while (1) switch (_context.n) {\n          case 0:\n            _context.n = 1;\n            return _this.loadLecturerCourses();\n          case 1:\n            if (!_this.courseId) {\n              _context.n = 2;\n              break;\n            }\n            _context.n = 2;\n            return _this.loadCourseData();\n          case 2:\n            return _context.a(2);\n        }\n      }, _callee);\n    }))();\n  },\n  methods: {\n    loadLecturerCourses: function loadLecturerCourses() {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2() {\n        var lecturerId, response, data, _t;\n        return _regenerator().w(function (_context2) {\n          while (1) switch (_context2.n) {\n            case 0:\n              _context2.p = 0;\n              if (_this2.userId) {\n                _context2.n = 1;\n                break;\n              }\n              throw new Error('User not authenticated');\n            case 1:\n              lecturerId = _this2.userId;\n              _context2.n = 2;\n              return fetch(\"http://localhost/marks-api.php?action=lecturer_courses&lecturer_id=\".concat(lecturerId), {\n                method: 'GET',\n                credentials: 'include',\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n            case 2:\n              response = _context2.v;\n              if (response.ok) {\n                _context2.n = 3;\n                break;\n              }\n              throw new Error(\"HTTP error! status: \".concat(response.status));\n            case 3:\n              _context2.n = 4;\n              return response.json();\n            case 4:\n              data = _context2.v;\n              if (!data.error) {\n                _context2.n = 5;\n                break;\n              }\n              throw new Error(data.error);\n            case 5:\n              _this2.lecturerCourses = data.courses || [];\n              console.log('Loaded lecturer courses:', _this2.lecturerCourses);\n              _context2.n = 7;\n              break;\n            case 6:\n              _context2.p = 6;\n              _t = _context2.v;\n              console.error('Error loading lecturer courses:', _t);\n              _this2.$store.dispatch('showToast', {\n                message: 'Error loading courses: ' + _t.message,\n                type: 'error'\n              });\n              _this2.lecturerCourses = [];\n            case 7:\n              return _context2.a(2);\n          }\n        }, _callee2, null, [[0, 6]]);\n      }))();\n    },\n    loadCourseData: function loadCourseData() {\n      var _this3 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee3() {\n        var _t2;\n        return _regenerator().w(function (_context3) {\n          while (1) switch (_context3.n) {\n            case 0:\n              if (_this3.courseId) {\n                _context3.n = 1;\n                break;\n              }\n              return _context3.a(2);\n            case 1:\n              _this3.isLoading = true;\n              _context3.p = 2;\n              // Find the selected course\n              _this3.course = _this3.lecturerCourses.find(function (c) {\n                return c.id == _this3.courseId;\n              });\n\n              // Load students for this course with their marks\n              _context3.n = 3;\n              return _this3.loadStudentsWithMarks();\n            case 3:\n              _context3.n = 5;\n              break;\n            case 4:\n              _context3.p = 4;\n              _t2 = _context3.v;\n              console.error('Error loading course data:', _t2);\n              _this3.$store.dispatch('showToast', {\n                message: 'Error loading course data',\n                type: 'error'\n              });\n            case 5:\n              _context3.p = 5;\n              _this3.isLoading = false;\n              return _context3.f(5);\n            case 6:\n              return _context3.a(2);\n          }\n        }, _callee3, null, [[2, 4, 5, 6]]);\n      }))();\n    },\n    loadStudentsWithMarks: function loadStudentsWithMarks() {\n      var _this4 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee4() {\n        var response, data, _t3;\n        return _regenerator().w(function (_context4) {\n          while (1) switch (_context4.n) {\n            case 0:\n              _context4.p = 0;\n              _context4.n = 1;\n              return fetch(\"http://localhost/marks-api.php?action=course_students_marks&course_id=\".concat(_this4.courseId), {\n                method: 'GET',\n                credentials: 'include',\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n            case 1:\n              response = _context4.v;\n              if (response.ok) {\n                _context4.n = 2;\n                break;\n              }\n              throw new Error(\"HTTP error! status: \".concat(response.status));\n            case 2:\n              _context4.n = 3;\n              return response.json();\n            case 3:\n              data = _context4.v;\n              if (!data.error) {\n                _context4.n = 4;\n                break;\n              }\n              throw new Error(data.error);\n            case 4:\n              // Map the API response to the expected format\n              _this4.students = data.students.map(function (student) {\n                return {\n                  id: student.student_id,\n                  name: student.student_name,\n                  email: student.email || 'N/A',\n                  matric_number: student.matric_number,\n                  marks: {\n                    assignment: student.assignment_mark || 0,\n                    quiz: student.quiz_mark || 0,\n                    test: student.test_mark || 0,\n                    final_exam: student.final_exam_mark || 0,\n                    final_mark: student.final_grade || 0,\n                    grade: student.letter_grade || 'F'\n                  }\n                };\n              });\n\n              // Calculate final marks for all students to ensure they're up to date\n              _this4.students.forEach(function (student) {\n                _this4.calculateFinalMark(student);\n              });\n              console.log('Loaded students with marks:', _this4.students);\n              _context4.n = 6;\n              break;\n            case 5:\n              _context4.p = 5;\n              _t3 = _context4.v;\n              console.error('Error loading students with marks:', _t3);\n              _this4.$store.dispatch('showToast', {\n                message: 'Error loading student marks: ' + _t3.message,\n                type: 'error'\n              });\n\n              // Fallback to empty array\n              _this4.students = [];\n            case 6:\n              return _context4.a(2);\n          }\n        }, _callee4, null, [[0, 5]]);\n      }))();\n    },\n    calculateFinalMark: function calculateFinalMark(student) {\n      var marks = student.marks;\n\n      // Check if all marks are entered\n      var assignment = marks.assignment || 0;\n      var quiz = marks.quiz || 0;\n      var test = marks.test || 0;\n      var finalExam = marks.final_exam || 0;\n\n      // Calculate final mark: Components (70%) + Final Exam (30%)\n      // Components breakdown: Assignment (25%) + Quiz (20%) + Test (25%)\n      var componentMark = assignment * 0.25 + quiz * 0.20 + test * 0.25;\n      var finalMark = componentMark * 0.70 + finalExam * 0.30;\n      marks.final_mark = finalMark;\n      marks.grade = this.calculateGrade(finalMark);\n      this.unsavedChanges = true;\n    },\n    calculateGrade: function calculateGrade(finalMark) {\n      if (finalMark >= 80) return 'A';\n      if (finalMark >= 70) return 'B';\n      if (finalMark >= 60) return 'C';\n      if (finalMark >= 50) return 'D';\n      return 'F';\n    },\n    calculateAllFinalMarks: function calculateAllFinalMarks() {\n      var _this5 = this;\n      this.students.forEach(function (student) {\n        _this5.calculateFinalMark(student);\n      });\n      this.$store.dispatch('showToast', {\n        message: 'Final marks calculated for all students',\n        type: 'success'\n      });\n    },\n    saveStudentMarks: function saveStudentMarks(student) {\n      var _this6 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee5() {\n        var lecturerId, requestData, response, data, _t4;\n        return _regenerator().w(function (_context5) {\n          while (1) switch (_context5.n) {\n            case 0:\n              _context5.p = 0;\n              if (_this6.userId) {\n                _context5.n = 1;\n                break;\n              }\n              throw new Error('User not authenticated');\n            case 1:\n              lecturerId = _this6.userId;\n              requestData = {\n                action: 'save_marks',\n                student_id: student.id,\n                course_id: _this6.courseId,\n                lecturer_id: lecturerId,\n                marks: {\n                  assignment: student.marks.assignment || 0,\n                  quiz: student.marks.quiz || 0,\n                  test: student.marks.test || 0,\n                  final_exam: student.marks.final_exam || 0\n                }\n              };\n              _context5.n = 2;\n              return fetch('http://localhost/marks-api.php', {\n                method: 'POST',\n                credentials: 'include',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(requestData)\n              });\n            case 2:\n              response = _context5.v;\n              if (response.ok) {\n                _context5.n = 3;\n                break;\n              }\n              throw new Error(\"HTTP error! status: \".concat(response.status));\n            case 3:\n              _context5.n = 4;\n              return response.json();\n            case 4:\n              data = _context5.v;\n              if (!data.error) {\n                _context5.n = 5;\n                break;\n              }\n              throw new Error(data.error);\n            case 5:\n              console.log('Marks saved successfully for student:', student.name);\n              _this6.$store.dispatch('showToast', {\n                message: \"Marks saved for \".concat(student.name),\n                type: 'success'\n              });\n              _context5.n = 7;\n              break;\n            case 6:\n              _context5.p = 6;\n              _t4 = _context5.v;\n              console.error('Error saving student marks:', _t4);\n              _this6.$store.dispatch('showToast', {\n                message: \"Error saving marks for \".concat(student.name, \": \").concat(_t4.message),\n                type: 'error'\n              });\n              throw _t4;\n            case 7:\n              return _context5.a(2);\n          }\n        }, _callee5, null, [[0, 6]]);\n      }))();\n    },\n    saveAllMarks: function saveAllMarks() {\n      var _this7 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee6() {\n        var _iterator, _step, student, _t5, _t6;\n        return _regenerator().w(function (_context6) {\n          while (1) switch (_context6.n) {\n            case 0:\n              if (_this7.unsavedChanges) {\n                _context6.n = 1;\n                break;\n              }\n              _this7.$store.dispatch('showToast', {\n                message: 'No changes to save',\n                type: 'info'\n              });\n              return _context6.a(2);\n            case 1:\n              _this7.isLoading = true;\n              _context6.p = 2;\n              // Save all student marks to API\n              _iterator = _createForOfIteratorHelper(_this7.students);\n              _context6.p = 3;\n              _iterator.s();\n            case 4:\n              if ((_step = _iterator.n()).done) {\n                _context6.n = 6;\n                break;\n              }\n              student = _step.value;\n              _context6.n = 5;\n              return _this7.saveStudentMarks(student);\n            case 5:\n              _context6.n = 4;\n              break;\n            case 6:\n              _context6.n = 8;\n              break;\n            case 7:\n              _context6.p = 7;\n              _t5 = _context6.v;\n              _iterator.e(_t5);\n            case 8:\n              _context6.p = 8;\n              _iterator.f();\n              return _context6.f(8);\n            case 9:\n              _this7.unsavedChanges = false;\n              _this7.$store.dispatch('showToast', {\n                message: 'All marks saved successfully',\n                type: 'success'\n              });\n              _context6.n = 11;\n              break;\n            case 10:\n              _context6.p = 10;\n              _t6 = _context6.v;\n              console.error('Error saving all marks:', _t6);\n              _this7.$store.dispatch('showToast', {\n                message: 'Error saving marks',\n                type: 'error'\n              });\n            case 11:\n              _context6.p = 11;\n              _this7.isLoading = false;\n              return _context6.f(11);\n            case 12:\n              return _context6.a(2);\n          }\n        }, _callee6, null, [[3, 7, 8, 9], [2, 10, 11, 12]]);\n      }))();\n    },\n    exportMarks: function exportMarks() {\n      var _this$course;\n      if (!this.students.length) {\n        this.$store.dispatch('showToast', {\n          message: 'No marks to export',\n          type: 'warning'\n        });\n        return;\n      }\n\n      // Create CSV data\n      var headers = ['Student Name', 'Matric Number', 'Assignment', 'Quiz', 'Test', 'Final Exam', 'Final Mark', 'Grade'];\n      var csvData = [headers];\n      this.students.forEach(function (student) {\n        var row = [student.name, student.matric_number || 'N/A', student.marks.assignment || '', student.marks.quiz || '', student.marks.test || '', student.marks.final_exam || '', student.marks.final_mark ? student.marks.final_mark.toFixed(1) : '', student.marks.grade || ''];\n        csvData.push(row);\n      });\n\n      // Convert to CSV string\n      var csvString = csvData.map(function (row) {\n        return row.join(',');\n      }).join('\\n');\n\n      // Download CSV\n      var blob = new Blob([csvString], {\n        type: 'text/csv'\n      });\n      var url = window.URL.createObjectURL(blob);\n      var a = document.createElement('a');\n      a.href = url;\n      a.download = \"\".concat((_this$course = this.course) === null || _this$course === void 0 ? void 0 : _this$course.code, \"_marks_\").concat(new Date().toISOString().split('T')[0], \".csv\");\n      a.click();\n      window.URL.revokeObjectURL(url);\n      this.$store.dispatch('showToast', {\n        message: 'Marks exported successfully',\n        type: 'success'\n      });\n    },\n    showMarkingGuide: function showMarkingGuide() {\n      var modal = new bootstrap.Modal(document.getElementById('markingGuideModal'));\n      modal.show();\n    },\n    viewStudentDetails: function viewStudentDetails(student) {\n      this.$router.push(\"/lecturer/student/\".concat(student.id));\n    },\n    getStudentInitials: function getStudentInitials(name) {\n      return name.split(' ').map(function (n) {\n        return n.charAt(0);\n      }).join('').toUpperCase();\n    },\n    getGradeBadgeClass: function getGradeBadgeClass(grade) {\n      var gradeClasses = {\n        'A': 'bg-success',\n        'B': 'bg-info',\n        'C': 'bg-warning text-dark',\n        'D': 'bg-secondary',\n        'F': 'bg-danger'\n      };\n      return gradeClasses[grade] || 'bg-light text-dark';\n    }\n  }\n};","map":{"version":3,"names":["mapGetters","bootstrap","name","data","courseId","$route","params","course","students","lecturerCourses","isLoading","unsavedChanges","computed","_objectSpread","currentUser","getUser","created","_this","_asyncToGenerator","_regenerator","m","_callee","w","_context","n","loadLecturerCourses","loadCourseData","a","methods","_this2","_callee2","lecturerId","response","_t","_context2","p","userId","Error","fetch","concat","method","credentials","headers","v","ok","status","json","error","courses","console","log","$store","dispatch","message","type","_this3","_callee3","_t2","_context3","find","c","id","loadStudentsWithMarks","f","_this4","_callee4","_t3","_context4","map","student","student_id","student_name","email","matric_number","marks","assignment","assignment_mark","quiz","quiz_mark","test","test_mark","final_exam","final_exam_mark","final_mark","final_grade","grade","letter_grade","forEach","calculateFinalMark","finalExam","componentMark","finalMark","calculateGrade","calculateAllFinalMarks","_this5","saveStudentMarks","_this6","_callee5","requestData","_t4","_context5","action","course_id","lecturer_id","body","JSON","stringify","saveAllMarks","_this7","_callee6","_iterator","_step","_t5","_t6","_context6","_createForOfIteratorHelper","s","done","value","e","exportMarks","_this$course","length","csvData","row","toFixed","push","csvString","join","blob","Blob","url","window","URL","createObjectURL","document","createElement","href","download","code","Date","toISOString","split","click","revokeObjectURL","showMarkingGuide","modal","Modal","getElementById","show","viewStudentDetails","$router","getStudentInitials","charAt","toUpperCase","getGradeBadgeClass","gradeClasses"],"sources":["C:\\Users\\ansmu\\Desktop\\Web\\course-mark-management\\frontend\\src\\views\\lecturer\\MarksManagement.vue"],"sourcesContent":["<template>\r\n  <div class=\"marks-management\">\r\n    <!-- Header -->\r\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n      <div>\r\n        <nav aria-label=\"breadcrumb\">\r\n          <ol class=\"breadcrumb\">\r\n            <li class=\"breadcrumb-item\">\r\n              <router-link to=\"/lecturer/dashboard\">Dashboard</router-link>\r\n            </li>\r\n            <li class=\"breadcrumb-item\">\r\n              <router-link :to=\"`/lecturer/course/${courseId}`\">{{ course?.code }}</router-link>\r\n            </li>\r\n            <li class=\"breadcrumb-item active\" aria-current=\"page\">Marks Management</li>\r\n          </ol>\r\n        </nav>\r\n        <h1 class=\"mb-2\">Marks Management</h1>\r\n        <p class=\"text-muted\">\r\n          {{ course?.code }} - {{ course?.name }} | {{ course?.semester }}\r\n        </p>\r\n      </div>\r\n      <div class=\"btn-group\">\r\n        <button class=\"btn btn-success\" @click=\"saveAllMarks\" :disabled=\"isLoading\">\r\n          <i class=\"fas fa-save me-2\"></i>Save All Changes\r\n        </button>\r\n        <button class=\"btn btn-outline-primary\" @click=\"exportMarks\">\r\n          <i class=\"fas fa-file-export me-2\"></i>Export Marks\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Course Selection -->\r\n    <div class=\"card mb-4\">\r\n      <div class=\"card-body\">\r\n        <div class=\"row\">\r\n          <div class=\"col-md-6\">\r\n            <label for=\"courseSelect\" class=\"form-label\">Select Course:</label>\r\n            <select \r\n              id=\"courseSelect\" \r\n              v-model=\"courseId\" \r\n              @change=\"loadCourseData\"\r\n              class=\"form-select\"\r\n            >\r\n              <option value=\"\">Select a course...</option>\r\n              <option \r\n                v-for=\"course in lecturerCourses\" \r\n                :key=\"course.id\" \r\n                :value=\"course.id\"\r\n              >\r\n                {{ course.code }} - {{ course.name }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n          <div class=\"col-md-6\">\r\n            <label class=\"form-label\">Assessment Breakdown:</label>\r\n            <div class=\"d-flex gap-3\">\r\n              <div class=\"badge bg-primary p-2\">\r\n                <i class=\"fas fa-tasks me-2\"></i>Components: 70%\r\n              </div>\r\n              <div class=\"badge bg-warning p-2\">\r\n                <i class=\"fas fa-graduation-cap me-2\"></i>Final Exam: 30%\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-if=\"isLoading\" class=\"text-center my-5\">\r\n      <div class=\"spinner-border text-primary\" role=\"status\">\r\n        <span class=\"visually-hidden\">Loading...</span>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-else-if=\"!courseId\" class=\"text-center my-5\">\r\n      <i class=\"fas fa-book-open text-muted mb-3\" style=\"font-size: 3rem;\"></i>\r\n      <h5 class=\"text-muted\">Select a Course</h5>\r\n      <p class=\"text-muted\">Choose a course from the dropdown above to manage student marks.</p>\r\n    </div>\r\n\r\n    <div v-else-if=\"students.length === 0\" class=\"text-center my-5\">\r\n      <i class=\"fas fa-users text-muted mb-3\" style=\"font-size: 3rem;\"></i>\r\n      <h5 class=\"text-muted\">No Students Enrolled</h5>\r\n      <p class=\"text-muted\">There are no students enrolled in this course yet.</p>\r\n    </div>\r\n\r\n    <!-- Marks Table -->\r\n    <div v-else class=\"card\">\r\n      <div class=\"card-header bg-light\">\r\n        <div class=\"d-flex justify-content-between align-items-center\">\r\n          <h5 class=\"mb-0\">Student Marks</h5>\r\n          <div class=\"d-flex gap-2\">\r\n            <button class=\"btn btn-sm btn-outline-success\" @click=\"calculateAllFinalMarks\">\r\n              <i class=\"fas fa-calculator me-2\"></i>Calculate Final Marks\r\n            </button>\r\n            <button class=\"btn btn-sm btn-outline-info\" @click=\"showMarkingGuide\">\r\n              <i class=\"fas fa-info-circle me-2\"></i>Marking Guide\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"card-body p-0\">\r\n        <div class=\"table-responsive\">\r\n          <table class=\"table table-hover mb-0\">\r\n            <thead class=\"table-light\">\r\n              <tr>\r\n                <th rowspan=\"2\" class=\"align-middle\">Student</th>\r\n                <th rowspan=\"2\" class=\"align-middle\">Matric No.</th>\r\n                <th colspan=\"3\" class=\"text-center bg-primary text-white\">Components (70%)</th>\r\n                <th rowspan=\"2\" class=\"align-middle bg-warning text-dark\">Final Exam (30%)</th>\r\n                <th rowspan=\"2\" class=\"align-middle bg-success text-white\">Final Mark</th>\r\n                <th rowspan=\"2\" class=\"align-middle\">Grade</th>\r\n                <th rowspan=\"2\" class=\"align-middle\">Actions</th>\r\n              </tr>\r\n              <tr>\r\n                <th class=\"bg-primary text-white\">Assignment</th>\r\n                <th class=\"bg-primary text-white\">Quiz</th>\r\n                <th class=\"bg-primary text-white\">Test</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"student in students\" :key=\"student.id\">\r\n                <td>\r\n                  <div class=\"d-flex align-items-center\">\r\n                    <div class=\"avatar avatar-sm me-3\">\r\n                      {{ getStudentInitials(student.name) }}\r\n                    </div>\r\n                    <div>\r\n                      <strong>{{ student.name }}</strong>\r\n                      <br>\r\n                      <small class=\"text-muted\">{{ student.email }}</small>\r\n                    </div>\r\n                  </div>\r\n                </td>\r\n                <td>{{ student.matric_number || 'N/A' }}</td>\r\n                \r\n                <!-- Component Marks (70%) -->\r\n                <td>\r\n                  <input \r\n                    type=\"number\" \r\n                    class=\"form-control form-control-sm\"\r\n                    v-model.number=\"student.marks.assignment\"\r\n                    @input=\"calculateFinalMark(student)\"\r\n                    min=\"0\" \r\n                    max=\"100\"\r\n                    placeholder=\"0-100\"\r\n                  >\r\n                </td>\r\n                <td>\r\n                  <input \r\n                    type=\"number\" \r\n                    class=\"form-control form-control-sm\"\r\n                    v-model.number=\"student.marks.quiz\"\r\n                    @input=\"calculateFinalMark(student)\"\r\n                    min=\"0\" \r\n                    max=\"100\"\r\n                    placeholder=\"0-100\"\r\n                  >\r\n                </td>\r\n                <td>\r\n                  <input \r\n                    type=\"number\" \r\n                    class=\"form-control form-control-sm\"\r\n                    v-model.number=\"student.marks.test\"\r\n                    @input=\"calculateFinalMark(student)\"\r\n                    min=\"0\" \r\n                    max=\"100\"\r\n                    placeholder=\"0-100\"\r\n                  >\r\n                </td>\r\n                \r\n                <!-- Final Exam (30%) -->\r\n                <td>\r\n                  <input \r\n                    type=\"number\" \r\n                    class=\"form-control form-control-sm\"\r\n                    v-model.number=\"student.marks.final_exam\"\r\n                    @input=\"calculateFinalMark(student)\"\r\n                    min=\"0\" \r\n                    max=\"100\"\r\n                    placeholder=\"0-100\"\r\n                  >\r\n                </td>\r\n                \r\n                <!-- Final Mark -->\r\n                <td>\r\n                  <span class=\"badge bg-success fs-6\">\r\n                    {{ student.marks.final_mark ? student.marks.final_mark.toFixed(1) : 'N/A' }}\r\n                  </span>\r\n                </td>\r\n                \r\n                <!-- Grade -->\r\n                <td>\r\n                  <span class=\"badge\" :class=\"getGradeBadgeClass(student.marks.grade)\">\r\n                    {{ student.marks.grade || 'N/A' }}\r\n                  </span>\r\n                </td>\r\n                \r\n                <!-- Actions -->\r\n                <td>\r\n                  <div class=\"btn-group btn-group-sm\">\r\n                    <button \r\n                      class=\"btn btn-outline-primary\"\r\n                      @click=\"viewStudentDetails(student)\"\r\n                      title=\"View Details\"\r\n                    >\r\n                      <i class=\"fas fa-eye\"></i>\r\n                    </button>\r\n                    <button \r\n                      class=\"btn btn-outline-success\"\r\n                      @click=\"saveStudentMarks(student)\"\r\n                      title=\"Save Marks\"\r\n                    >\r\n                      <i class=\"fas fa-save\"></i>\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Marking Guide Modal -->\r\n    <div class=\"modal fade\" id=\"markingGuideModal\" tabindex=\"-1\" aria-labelledby=\"markingGuideModalLabel\" aria-hidden=\"true\">\r\n      <div class=\"modal-dialog modal-lg\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\" id=\"markingGuideModalLabel\">Marking Guide</h5>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"row\">\r\n              <div class=\"col-md-6\">\r\n                <h6>Assessment Breakdown</h6>\r\n                <ul class=\"list-group list-group-flush\">\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span>Assignment</span>\r\n                    <span class=\"badge bg-primary\">25%</span>\r\n                  </li>\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span>Quiz</span>\r\n                    <span class=\"badge bg-primary\">20%</span>\r\n                  </li>\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span>Test</span>\r\n                    <span class=\"badge bg-primary\">25%</span>\r\n                  </li>\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span><strong>Components Total</strong></span>\r\n                    <span class=\"badge bg-primary\"><strong>70%</strong></span>\r\n                  </li>\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span><strong>Final Exam</strong></span>\r\n                    <span class=\"badge bg-warning text-dark\"><strong>30%</strong></span>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n              <div class=\"col-md-6\">\r\n                <h6>Grading Scale</h6>\r\n                <ul class=\"list-group list-group-flush\">\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span>A</span>\r\n                    <span>80-100</span>\r\n                  </li>\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span>B</span>\r\n                    <span>70-79</span>\r\n                  </li>\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span>C</span>\r\n                    <span>60-69</span>\r\n                  </li>\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span>D</span>\r\n                    <span>50-59</span>\r\n                  </li>\r\n                  <li class=\"list-group-item d-flex justify-content-between\">\r\n                    <span>F</span>\r\n                    <span>0-49</span>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n            <div class=\"mt-3\">\r\n              <h6>Calculation Formula</h6>\r\n              <div class=\"alert alert-info\">\r\n                <strong>Final Mark = (Assignment × 0.25) + (Quiz × 0.20) + (Test × 0.25) + (Final Exam × 0.30)</strong>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapGetters } from 'vuex';\r\nimport * as bootstrap from 'bootstrap';\r\n\r\nexport default {\r\n  name: 'MarksManagement',\r\n  data() {\r\n    return {\r\n      courseId: this.$route.params.courseId || '',\r\n      course: null,\r\n      students: [],\r\n      lecturerCourses: [],\r\n      isLoading: false,\r\n      unsavedChanges: false\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapGetters('auth', ['getUser', 'userId']),\r\n    currentUser() {\r\n      return this.getUser;\r\n    }\r\n  },\r\n  async created() {\r\n    await this.loadLecturerCourses();\r\n    if (this.courseId) {\r\n      await this.loadCourseData();\r\n    }\r\n  },\r\n  methods: {\r\n    async loadLecturerCourses() {\r\n      try {\r\n        if (!this.userId) {\r\n          throw new Error('User not authenticated');\r\n        }\r\n        \r\n        const lecturerId = this.userId;\r\n        \r\n        const response = await fetch(`http://localhost/marks-api.php?action=lecturer_courses&lecturer_id=${lecturerId}`, {\r\n          method: 'GET',\r\n          credentials: 'include',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP error! status: ${response.status}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n        \r\n        if (data.error) {\r\n          throw new Error(data.error);\r\n        }\r\n\r\n        this.lecturerCourses = data.courses || [];\r\n        console.log('Loaded lecturer courses:', this.lecturerCourses);\r\n\r\n      } catch (error) {\r\n        console.error('Error loading lecturer courses:', error);\r\n        this.$store.dispatch('showToast', {\r\n          message: 'Error loading courses: ' + error.message,\r\n          type: 'error'\r\n        });\r\n        this.lecturerCourses = [];\r\n      }\r\n    },\r\n\r\n    async loadCourseData() {\r\n      if (!this.courseId) return;\r\n      \r\n      this.isLoading = true;\r\n      try {\r\n        // Find the selected course\r\n        this.course = this.lecturerCourses.find(c => c.id == this.courseId);\r\n        \r\n        // Load students for this course with their marks\r\n        await this.loadStudentsWithMarks();\r\n        \r\n      } catch (error) {\r\n        console.error('Error loading course data:', error);\r\n        this.$store.dispatch('showToast', {\r\n          message: 'Error loading course data',\r\n          type: 'error'\r\n        });\r\n      } finally {\r\n        this.isLoading = false;\r\n      }\r\n    },\r\n\r\n    async loadStudentsWithMarks() {\r\n      try {\r\n        // Make API call to get students with marks for this course\r\n        const response = await fetch(`http://localhost/marks-api.php?action=course_students_marks&course_id=${this.courseId}`, {\r\n          method: 'GET',\r\n          credentials: 'include',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP error! status: ${response.status}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n        \r\n        if (data.error) {\r\n          throw new Error(data.error);\r\n        }\r\n\r\n        // Map the API response to the expected format\r\n        this.students = data.students.map(student => ({\r\n          id: student.student_id,\r\n          name: student.student_name,\r\n          email: student.email || 'N/A',\r\n          matric_number: student.matric_number,\r\n          marks: {\r\n            assignment: student.assignment_mark || 0,\r\n            quiz: student.quiz_mark || 0,\r\n            test: student.test_mark || 0,\r\n            final_exam: student.final_exam_mark || 0,\r\n            final_mark: student.final_grade || 0,\r\n            grade: student.letter_grade || 'F'\r\n          }\r\n        }));\r\n\r\n        // Calculate final marks for all students to ensure they're up to date\r\n        this.students.forEach(student => {\r\n          this.calculateFinalMark(student);\r\n        });\r\n\r\n        console.log('Loaded students with marks:', this.students);\r\n\r\n      } catch (error) {\r\n        console.error('Error loading students with marks:', error);\r\n        this.$store.dispatch('showToast', {\r\n          message: 'Error loading student marks: ' + error.message,\r\n          type: 'error'\r\n        });\r\n        \r\n        // Fallback to empty array\r\n        this.students = [];\r\n      }\r\n    },\r\n\r\n    calculateFinalMark(student) {\r\n      const marks = student.marks;\r\n      \r\n      // Check if all marks are entered\r\n      const assignment = marks.assignment || 0;\r\n      const quiz = marks.quiz || 0;\r\n      const test = marks.test || 0;\r\n      const finalExam = marks.final_exam || 0;\r\n      \r\n      // Calculate final mark: Components (70%) + Final Exam (30%)\r\n      // Components breakdown: Assignment (25%) + Quiz (20%) + Test (25%)\r\n      const componentMark = (assignment * 0.25) + (quiz * 0.20) + (test * 0.25);\r\n      const finalMark = (componentMark * 0.70) + (finalExam * 0.30);\r\n      \r\n      marks.final_mark = finalMark;\r\n      marks.grade = this.calculateGrade(finalMark);\r\n      \r\n      this.unsavedChanges = true;\r\n    },\r\n\r\n    calculateGrade(finalMark) {\r\n      if (finalMark >= 80) return 'A';\r\n      if (finalMark >= 70) return 'B';\r\n      if (finalMark >= 60) return 'C';\r\n      if (finalMark >= 50) return 'D';\r\n      return 'F';\r\n    },\r\n\r\n    calculateAllFinalMarks() {\r\n      this.students.forEach(student => {\r\n        this.calculateFinalMark(student);\r\n      });\r\n      \r\n      this.$store.dispatch('showToast', {\r\n        message: 'Final marks calculated for all students',\r\n        type: 'success'\r\n      });\r\n    },\r\n\r\n    async saveStudentMarks(student) {\r\n      try {\r\n        if (!this.userId) {\r\n          throw new Error('User not authenticated');\r\n        }\r\n        \r\n        const lecturerId = this.userId;\r\n        \r\n        const requestData = {\r\n          action: 'save_marks',\r\n          student_id: student.id,\r\n          course_id: this.courseId,\r\n          lecturer_id: lecturerId,\r\n          marks: {\r\n            assignment: student.marks.assignment || 0,\r\n            quiz: student.marks.quiz || 0,\r\n            test: student.marks.test || 0,\r\n            final_exam: student.marks.final_exam || 0\r\n          }\r\n        };\r\n\r\n        const response = await fetch('http://localhost/marks-api.php', {\r\n          method: 'POST',\r\n          credentials: 'include',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify(requestData)\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP error! status: ${response.status}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n        \r\n        if (data.error) {\r\n          throw new Error(data.error);\r\n        }\r\n\r\n        console.log('Marks saved successfully for student:', student.name);\r\n        \r\n        this.$store.dispatch('showToast', {\r\n          message: `Marks saved for ${student.name}`,\r\n          type: 'success'\r\n        });\r\n\r\n      } catch (error) {\r\n        console.error('Error saving student marks:', error);\r\n        this.$store.dispatch('showToast', {\r\n          message: `Error saving marks for ${student.name}: ${error.message}`,\r\n          type: 'error'\r\n        });\r\n        throw error; // Re-throw so saveAllMarks can handle it\r\n      }\r\n    },\r\n\r\n    async saveAllMarks() {\r\n      if (!this.unsavedChanges) {\r\n        this.$store.dispatch('showToast', {\r\n          message: 'No changes to save',\r\n          type: 'info'\r\n        });\r\n        return;\r\n      }\r\n\r\n      this.isLoading = true;\r\n      try {\r\n        // Save all student marks to API\r\n        for (const student of this.students) {\r\n          await this.saveStudentMarks(student);\r\n        }\r\n        \r\n        this.unsavedChanges = false;\r\n        this.$store.dispatch('showToast', {\r\n          message: 'All marks saved successfully',\r\n          type: 'success'\r\n        });\r\n      } catch (error) {\r\n        console.error('Error saving all marks:', error);\r\n        this.$store.dispatch('showToast', {\r\n          message: 'Error saving marks',\r\n          type: 'error'\r\n        });\r\n      } finally {\r\n        this.isLoading = false;\r\n      }\r\n    },\r\n\r\n    exportMarks() {\r\n      if (!this.students.length) {\r\n        this.$store.dispatch('showToast', {\r\n          message: 'No marks to export',\r\n          type: 'warning'\r\n        });\r\n        return;\r\n      }\r\n\r\n      // Create CSV data\r\n      const headers = ['Student Name', 'Matric Number', 'Assignment', 'Quiz', 'Test', 'Final Exam', 'Final Mark', 'Grade'];\r\n      const csvData = [headers];\r\n      \r\n      this.students.forEach(student => {\r\n        const row = [\r\n          student.name,\r\n          student.matric_number || 'N/A',\r\n          student.marks.assignment || '',\r\n          student.marks.quiz || '',\r\n          student.marks.test || '',\r\n          student.marks.final_exam || '',\r\n          student.marks.final_mark ? student.marks.final_mark.toFixed(1) : '',\r\n          student.marks.grade || ''\r\n        ];\r\n        csvData.push(row);\r\n      });\r\n\r\n      // Convert to CSV string\r\n      const csvString = csvData.map(row => row.join(',')).join('\\n');\r\n      \r\n      // Download CSV\r\n      const blob = new Blob([csvString], { type: 'text/csv' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement('a');\r\n      a.href = url;\r\n      a.download = `${this.course?.code}_marks_${new Date().toISOString().split('T')[0]}.csv`;\r\n      a.click();\r\n      window.URL.revokeObjectURL(url);\r\n      \r\n      this.$store.dispatch('showToast', {\r\n        message: 'Marks exported successfully',\r\n        type: 'success'\r\n      });\r\n    },\r\n\r\n    showMarkingGuide() {\r\n      const modal = new bootstrap.Modal(document.getElementById('markingGuideModal'));\r\n      modal.show();\r\n    },\r\n\r\n    viewStudentDetails(student) {\r\n      this.$router.push(`/lecturer/student/${student.id}`);\r\n    },\r\n\r\n    getStudentInitials(name) {\r\n      return name.split(' ').map(n => n.charAt(0)).join('').toUpperCase();\r\n    },\r\n\r\n    getGradeBadgeClass(grade) {\r\n      const gradeClasses = {\r\n        'A': 'bg-success',\r\n        'B': 'bg-info',\r\n        'C': 'bg-warning text-dark',\r\n        'D': 'bg-secondary',\r\n        'F': 'bg-danger'\r\n      };\r\n      return gradeClasses[grade] || 'bg-light text-dark';\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.marks-management h1 {\r\n  color: #2c3e50;\r\n  font-weight: 700;\r\n}\r\n\r\n.avatar {\r\n  width: 40px;\r\n  height: 40px;\r\n  background: linear-gradient(45deg, #007bff, #0056b3);\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: white;\r\n  font-weight: bold;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.table input.form-control-sm {\r\n  width: 80px;\r\n  text-align: center;\r\n}\r\n\r\n.table th {\r\n  font-weight: 600;\r\n  border-top: none;\r\n}\r\n\r\n.table td {\r\n  vertical-align: middle;\r\n}\r\n\r\n.card {\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n  border: none;\r\n  border-radius: 10px;\r\n}\r\n\r\n.breadcrumb-item a {\r\n  text-decoration: none;\r\n  color: #007bff;\r\n}\r\n\r\n.breadcrumb-item a:hover {\r\n  color: #0056b3;\r\n}\r\n\r\n.badge.fs-6 {\r\n  font-size: 0.9rem !important;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}